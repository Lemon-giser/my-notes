## 0. 命名

| name        | description         |
| ----------- | ------------------- |
| rec_        | 重分类              |
| slope_      | 坡度                |
| aspect_     | 坡向                |
| costDis_    | 成本距离            |
| euDis_      | 欧式距离            |
| euAllo_     | 欧式分配            |
| backlink_   | 回溯                |
| topo_       | 拓扑                |
| DEM_        | DEM                 |
| project_DEM | 投影DEM             |
| buffer_     | 缓冲区              |
| contour_    | 等值线              |
| hillshade_  | 山体阴影            |
| QFD         | 起伏度              |
| kernelD_    | 核密度KernelDensity |

## 3.4.1 某地区区块的拓扑关系建立

​	创建gdb
​	创建数据集
​	导入shp
​	对要素类建立子类型（属性-子类型，0为Non-Residential，1为Residential）
​	创建拓扑
​		设置名称和聚类容限（一定范围内的要素捕捉在一起，根据精度确定）

> ​			拓扑容差是要素各部分之间彼此相隔的最小距离。位于拓扑容差范围内的要素的折点和边将被捕捉在一起。默认情况下，向导会依据数据集的空间参考的精度给出最小拓扑容差。数据集的精度可定义每个线性测量单位对应的系统单位数，并控制数据集中存储的坐标的精确程度。

​		选择参与创建的要素类
​		设置拓扑等级的数目及拓扑中，每个要素类的等级

> ​			如果一个拓扑中包含多个要素类，则可赋予它们不同的等级。当要素的折点或边位于彼此的拓扑容差范围内时，要素类等级可控制究竟移动哪一个要素类以使其相互重合。等级较低的要素类将被捕捉到等级较高的要素类上。最高等级为 1；最低等级为 50。对于处于拓扑容差范围内的等级相同的要素，将对其进行几何平均处理。

​		添加规则
​	拓扑检验
​		打开编辑器，拓扑工具条，选择图层
​		检测拓扑错误，立即搜索
​	修改拓扑错误
​		将产生错误的要素的属性进行修改
​			选中，打开属性表，修改属性 	?
​		拓扑检验，选中区域
​	拓扑编辑
​		使用拓扑编辑工具，选中要素

## 3.4.2 某市区几何网络的建立

​	创建gdb
​	创建数据集
​	导入shp
​	建立几何网络
​		设置名称和是否捕捉要素
​		选择要包含的要素类
​		是否保留已启用值		?
​		设置连接要素类型
​		权重
​	添加新的几何网络要素类	?
​	定义网络规则	?

## 4.4 数据更新变换

​	矢量数据提取县界
​		选择要素
​		导出
​	合并DEM数据
​		数据管理数据-栅格-栅格数据集-镶嵌至新栅格
​		输出为.tif
​		像素类型		?
​		波段数		?
​		镶嵌运算符		?
​	DEM裁切县界DEM
​		Spatial空间 Analyst-提取分析-按腌膜提取
​	定义投影
​		数据管理工具-投影和变换-栅格-投影栅格
​		选择坐标系 和 重采样技术		?

## 5.3 上海市行政区划图制作

​	数据符号化
​	地图标注
​		手动标注双线河：绘图工具条
​	设置格网
​		参考格网
​	插入图例 比例尺 指北针

## 7.5.1 市区择房分析

​	主干道缓冲区
​		缓冲向导-选择所选要素-特定距离
​	商业中心
​		缓冲向导-根据YUZHI字段（大小数据）
​	高中、名胜
​		缓冲向导-特定距离
​	叠置分析
​		分析工具-叠加分析-相交
​	擦除
​		分析工具-叠加分析-擦除，输入相交，擦除为道路
​	对市区分级
​		在缓冲区图层分别添加字段，合适为1，不合适为-1
​		分析工具-叠加分析-联合 输入四个图层
​		添加class字段，字段计算器
​		符号化class

## 7.5.2 最短路径问题分析与应用

无权重最佳路径

​	几何网络分析中，分析选项的权重和权重过滤器均为无

加权最佳路径

​	权重中边要素更改

按要求和顺序

​	

设置阻强

## 8.10.1 学校选址

数据：娱乐场所，学校，土地利用类型，DEM

环境设置，工作空间，处理范围，像元大小

工具：Spatial Analysts--》表面分析/距离分析/地图代数--》坡度/欧氏距离/栅格计算器

DEM--》坡度--》重分类

学校，娱乐场所--》欧氏距离--》重分类

土地利用类型--》去除不适合要素--》重分类

栅格计算器 suit = 各个栅格*权重 相加

## 8.10.2 寻找最佳路径

数据：dem、河流、起点、终点

要求：路径成本少、较短、避开河流

成本：河流+坡度 * 0.6 + 起伏度 * 0.4

坡度成本：dem--》spatial analyst-表面分析-坡度

起伏度成本--》spatial analyst-邻域分析-焦点统计-高度宽度11*11 range  	

河流成本--》重分类

总成本--》栅格计算器

成本距离--》距离分析-成本距离，需要输出回溯数据

成本路径costPath--》成本路径

焦点统计

| 统计类型 | 介绍                                       | 应用       |
| -------- | ------------------------------------------ | ---------- |
| MEAN     | 计算邻域内像元的平均值                     |            |
| MAJORITY | 计算邻域内像元的众数（出现次数最多的值）   |            |
| MAXIMUM  | 计算邻域内像元的最大值                     | 提取山顶点 |
| MEDIAN   | 计算邻域内像元的中值                       |            |
| MINIMUM  | 计算邻域内像元的最小值                     |            |
| MINORITY | 计算邻域内像元的少数（出现次数最少的值）   |            |
| RANGE    | 计算邻域内像元的范围（最大值和最小值之差） | 地形起伏度 |
| STD      | 计算邻域内像元的标准差                     |            |
| SUM      | 计算邻域内像元的总和（所有值的总和）       |            |
| VARIETY  | 计算邻域内像元的变异度（唯一值的数量）     |            |

## 8.10.3 熊猫分布密度制图

密度制图

槽域特征

熊猫活动足迹--》欧式分配	最大距离5000	像元大小500	？

分配表--》添加area字段--》area=count * 500 * 500 栅格面积	？

xmpoint--》连接分配表--》添加power字段--》power = 3.1415926 * 5000 * 5000/area

核密度分析--》？

单位换算--》栅格计算器

## 8.10.4 GDP区域分布图的生成与对比

反距离权重内插（IDW）、样条函数（Spline）内插

IDW  幂2、5

Spline  

样条函数类型：regularized 权重0、0.1

样条函数类型：tension	权重0、5



对于山脊和沟谷，如果没有采样点，IDW不会生成

取样点足够密时，IDW对局部变化效果好

样条函数适合空间连续变化且光滑的表面的形成

## 8.10.5 山顶点的提取

等高线提取

spatial analyst--》表面分析--》等值线

表面分析--》山体阴影

焦点统计	11*11 统计类型为Maximum

栅格计算器，通过Maxpoint-dem==0计算，返回1的为山顶

重分类，0为nodata

转换工具-由栅格转出，输出点要素

手动删除边框上的点

## 9.6.1 地形指标提取

坡度变率SOS  二次坡度

H的计算----？设置环境，范围和像元大小

坡向变率：

H-DEM--》反地形DEM--》坡向--》坡度--》SOA2

DEM--》坡向--》坡度--》SOA1

(("SOA1" + "SOA2") - Abs("SOA1" - "SOA2")) / 2	？无法计算

地形起伏度

焦点统计，最大值减最小值，或者是RANGE	？结果不同

地面粗糙度：表面积与投影面积比



<img src="C:\Users\Lemon\OneDrive\笔记\图片\image-20201008163247474.png" alt="image-20201008163247474" style="zoom:67%;" />

AB面/AC面	1/Cos(Slope*3.14159/180)

## 9.6.2 地形特征信息提取

特征点：山顶点peak 凹陷点pit 脊点ridge 谷点channel 鞍点pass 平地点plane

特征线：山脊线（分水线） 山谷线（汇水线）

山脊线、山谷线，正地形提取山脊线，负地形提取山谷线

平面曲率（坡向曲率代替）与坡形组合法

？坡向曲率无法计算



## 9.6.3 表面创建及景观图制作###

3D分析工具--》数据管理--》创建TIN

3D分析工具--》转换--》由TIN转出--》TIN转栅格

设置其他图层基本高度

## 10.6 克里金方法内插生成高程曲面

数据：高程采样点	jyg.shp

jyg.shp --》子集要素--》jyg_training.shp

jyg_training.shp--》探索要素-直方图/正态QQ图--》查看是否符合正态分布--》是否进行数据变换

探索要素--》趋势分析--》查看是否存在趋势

地统计向导--》jyg_training	station	克里金--》泛克里金	预测	变换None	趋势的移除阶数First

--》方法属性--》修改步长--》探索邻域--》参考预测误差

标准：

1. 标准平均值接近0
2. 均方根最小
3. 平均值最接近均方根
4. 平均标准误差接近1

内插表面--》导出至栅格

## 11.7.1 利用水文分析方法提取山脊、山谷线

![image-20201011150027379](C:\Users\Lemon\OneDrive\笔记\图片\image-20201011150027379.png)

获取正负地形：dem焦点统计mean--》dem-mean--》大于0的为正地形，小于0的为负地形



山脊线：填洼--》流向--》流量--》流量==0--》焦点统计3x3平均值剔除不是山脊线的部分--》重分类二值化，根据等值线和山体阴影判断确定临界点--》与正地形相乘剔除负地形中的山脊线--》重分类只保留属性值为1的部分

山谷线：Abs(dem-2000)-》流向--》流量--》流量==0--》焦点统计3x3平均值剔除不是山谷线的部分--》重分类二值化，根据等值线和山体阴影判断确定临界点--》与负地形相乘剔除正地形中的山谷线--》重分类只保留属性值为1的部分

![在这里插入图片描述](C:\Users\Lemon\OneDrive\笔记\图片\20181126214002165.png)

## 11.7.2 地形鞍部的提取

提取山脊山谷

山脊与山谷相乘得到鞍部区

鞍部区与正地形相乘得到鞍部点

重分类鞍部点

转成矢量数据

剔除样区边缘和内部的伪鞍部点

> ​	正负地形11x11	表面光滑3x3

## 11.7.3 沟谷网络的提取及沟壑密度的计算

河谷网络的提取：

1. 查看是否有洼地的方法

   流向--》汇

2. 填洼--》流向--》流量

3. 计算河网数据stremnet

   设置一个河流阈值，streamnet = flowacc > 100

4. 栅格河网矢量化

   > ​	与栅格转折线的区别
   >
   > http://www.mamicode.com/info-detail-965917.html
   >
   > 帮助文档：栅格河网矢量化的工作原理

5. 去除伪沟谷

沟壑密度计算：

1.	沟壑数据属性表，在Length字段点击统计，得到∑L

 	2.	在DEM源查看栅格数据的行、列、栅格分辨率，计算出研究区域的面积A
 	3.	沟壑密度Ds = ∑L/A

## 12.2.3 图解建模实例分析

https://blog.csdn.net/qq_41496127/article/details/88248881

## 12.5.1 明暗等高线制作

DEM--》坡向-》大于45度小于225度--》加--》--》栅格转面

DEM--》50等值线--》标识--》明暗等高线	？

## 13.1 数据编辑与更新

新建个人数据库--》创建要素数据集--》导入要素--》创建拓扑，设置拓扑等级、规则、验证

加载拓扑--》拓扑检查--》数据管理数据-常规-合并

快捷键：z-缩放至	双击要素快速编辑	z+鼠标-放大	x+鼠标-缩小

## 13.2 寻找最短路径

数据：road_north	road_south_dl

流程：

南道路投影为road_south_GK --》合并 road_unite--》

新建数据库network.mdb--》新建数据集dataset--》导入为road--》新建拓扑-悬挂点

发现存在较大缝隙，因此需要接边：

空间校正工具条，校正方法为边捕捉

1. 使用边匹配工具：先设置校正属性，选择图层，编辑器中设置捕捉容差，为稍大于距离平均值		？

2. 使用新建位移连接

删除拓扑，创建几何网络

求最短路径

## 13.3 土壤稳定性评估

1. 坡度越陡，稳定性越低，临界值为3°，6°，11°，20°，30°

   10，8，7，5，3，1

2. 阴坡比阳坡稳定 -1，0~90，270~360，90~270

   5，10，10，1

3. 土地利用类型agriculture，river，grass，forest，urban

   2，8，6，10，4

4. 叠加分析-加权总和--》stability

   坡度0.3，坡向0.3，土地0.4

5. 符号系统分类，4以下不稳定，4~7较稳定，7以上很稳定

## 13.4 找出某种珍贵药材的生长区域

适合区域：

1. 沟谷两侧较近的区域，一般不超过500m

2. 喜阳

3. 生长气候环境为年平均温度10~12度

4. 年降水量为550~680mm

> 转为栅格的方法：1.构建TIN，TIN转栅格 2.地形转栅格，内插生成DEM
>
> 缓存区的方法：1.欧氏距离 2.转为矢量，缓冲区

沟谷：contour转为dem（构建TIN，软短线，采样距离为cellsize）--》填洼--》流向--》流量--》流量大于200--》生成缓冲区（欧氏距离）

喜阳：dem--》坡向--》重分类

温度：添加XY数据--》导出为要素--》内插，如反距离权重法--》栅格计算器

降水：内插--》栅格计算器

合适区域：沟谷×喜阳×温度×降水

？count数不同

## 实验1 

线编辑，绝对XY，长度，平行，垂直

## 实验2

编辑器-移动。选中要移动的要素，输入xy偏移量。

## 实验3

旋转。拖动或按A键。

## 实验4

镜像工具。选中要素后，绘制对称轴，或者选择已有线段。

比例。选中工具后，鼠标拖拽放大缩小，或按F键。

## 实验5 分割线要素

1. 以点分割要素。数据管理工具-要素-在点处分割要素
2. 在折点处分割要素。数据管理工具-要素-在折点处分割要素

## 实验6 提取线要素的交点

1. 分割线数据 

   数据管理工具-要素-要素转线

2. 提取要素端点

   数据管理工具-要素-要素折点转点

3. 获取点坐标字段

   数据管理工具-要素-添加XY坐标

4. 提取重复点要素

   数据管理工具-常规-删除相同的，勾选XY字段

## 实验7 拆分多部分要素

1. 数据管理工具-要素-多部件至单部件
2. 高级编辑-拆分多部件要素

之后重新计算面积

## 实验8 绘制中点连线

编辑器-追踪-中点

## 实验9 线要素的延伸与裁剪

高级编辑。先选中面要素，再选择延伸/裁剪工具，选择线。

## 实验10 绘制带空洞的面要素

绘制长江不包含岛屿。

1. 在同一个图层中，分别矢量化长江面和岛屿。选中一个岛屿，使用编辑器的裁剪。只能逐个裁剪。
2. 矢量化时不选择完成草图，而选择完成部件。
3. 分析工具-叠加分析-擦除

## 实验11,12 线分割面

1. 提取面的边界--合并边界线和分割线--要素转面

   工具：数据管理工具--要素--面转线，数据管理工具--常规--合并，数据管理工具--要素--要素转面

2. 要素转面，输入线和面

3. 高级编辑--分割面。此方法能保留属性值。

## 实验13 矢量化面图层

绘制多个面，处理公共边问题

1. 裁剪面工具

   先画出整个图，再画分割线

2. 自动完成面

   先画出一个小面

## 实验14 设置字段别名

在ArcCatalog中，创建gdb，导入要素类

在字段中可以修改字段名和字段别名

## 实验15 设置属性域

属性域可以是范围或者编码的值。

先创建文件数据库，设置数据库属性，属性域，添加属性域名称、描述，选中属性域，设置属性域属性，在编码值中添加编码和描述。

## 实验16 对字段进行自定义赋值

字段计算器，输入python代码

## 实验17 按条件计算属性字段值

字段计算器，显示代码块

## 实验18 合并表格

先将属性表导出

使用合并或追加工具

## 实验19 按值修改栅格值

条件分析--》条件函数（Con函数）

Con函数：Con("grid"==3,4."grid")

## 实验20 按像元修改栅格值

栅格转点--》修改属性值--》选中点--》转为栅格

## 实验21 按区域修改栅格值

面转栅格--》修改栅格值--》镶嵌至新栅格

输入栅格先选择原始栅格，再选择新栅格

## 实验22 NoData数据处理

将NoData赋值的方法：

1. 栅格计算器：Con(IsNull("dem"),1,"dem")

2. 重分类工具，将Nodata赋值为2，其他旧值赋值为Nodata，输出

   镶嵌至新栅格

3. 转为ASCII表，将-9999替换为3，第六行不变

   ASCII表转为栅格

## 实验23 提取栅格有效值边界

1. 提取3d边界

   3D分析工具--》转换--》由栅格转出--》栅格范围

2. 提取外边界线

   栅格计算器，提取大于0的值--》栅格转面（取消简化面）--》面转线

## 实验24 提取栅格独立格网面

栅格转点---》创建泰森多边形

不能使用栅格转面，会将值相同的格网融合

## 实验25 统一多分辨率栅格数据

1. 设置环境：

   处理范围与raster1一致，捕捉栅格设置为raster2

   像元大小与raster2一致

2. 重采样

   输出像元大小与raster2一致--》newraster1（NEAREST）

3. 调整栅格结构

   newraster1*1

## 实验26 创建多分辨率DEM

栅格转点--》创建TIN--》TIN转栅格（CELLSIZE 30）

重采样（NEAREST）

重采样是最方便的方法

## 实验27 细分栅格

方法一：环境像元大小10，栅格计算器raster*1

方法二：焦点统计3*3矩形

方法三：重采样（BILINEAR）

## 实验28 地形图配准

注意校正和一阶多项式的区别

四角可以使用校正

## 实验29 矢量数据空间校正

空间校正工具条

1. 方法：变换仿射

   仅平移，不能发生变形

2. 方法：橡皮页变换

   发生了变形

## 实验30 清除坐标系信息

## 实验31 纠正栅格坐标

转为ASCII，修改，转为栅格

转为栅格后没有坐标信息

## 实验32 计算栅格行列号

如：左下角为（1，1），

col = Int（x坐标-左范围）+1

row =  Int（y坐标-下范围）+1

Column = Int ( ([POINT_X]-5280.8177688837) /30 ) +1

## 实验33 计算栅格统计参数

获取栅格属性的方法：

1. 获取栅格属性工具
2. 打开源数据

## 实验34 浮点型栅格转整形

数学分析--》转为整形

## 实验35 等高线生成DEM

方法一：构建TIN，TIN转栅格

方法二：插值分析--》地形转栅格

## 实验36 创建特征线约束TIN

创建TIN，硬断线，约束性

编辑TIN